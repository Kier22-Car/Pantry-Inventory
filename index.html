<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pantry Inventory</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 10px;
      background-color: #f9f9f9;
    }

    h1, h2 {
      text-align: center;
    }

    select, input, button {
      display: block;
      margin: 10px auto;
      padding: 10px;
      width: 90%;
      max-width: 400px;
      box-sizing: border-box;
      font-size: 16px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background: white;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }

    th {
      background-color: #eee;
    }

    .edit-form {
      background: #fff;
      border: 1px solid #ccc;
      padding: 15px;
      margin-top: 20px;
      display: none;
    }

    .edit-form h3 {
      margin-top: 0;
    }

    @media (max-width: 600px) {
      table, thead, tbody, th, td, tr {
        display: block;
      }

      th {
        display: none;
      }

      td {
        border: none;
        position: relative;
        padding-left: 50%;
      }

      td::before {
        position: absolute;
        top: 8px;
        left: 8px;
        width: 45%;
        white-space: nowrap;
        font-weight: bold;
      }

      td:nth-of-type(1)::before { content: "Item"; }
      td:nth-of-type(2)::before { content: "Quantity"; }
      td:nth-of-type(3)::before { content: "Actions"; }
    }
  </style>
</head>
<body>

<h1>Pantry Inventory</h1>

<select id="pantrySelect"></select>

<h2 id="currentPantryTitle"></h2>

<input type="text" id="itemName" placeholder="Item name" />
<input type="number" id="itemQty" placeholder="Quantity" min="1" />
<button onclick="addItem()">Add Item</button>

<table id="itemTable" style="display:none;">
  <thead>
    <tr><th>Item</th><th>Quantity</th><th>Actions</th></tr>
  </thead>
  <tbody></tbody>
</table>

<div class="edit-form" id="editForm">
  <h3>Edit Item</h3>
  <input type="text" id="editItemName" disabled />
  <input type="number" id="editItemQty" />
  <button onclick="updateItem()">Update</button>
  <button onclick="cancelEdit()">Cancel</button>
</div>

<script>
  const data = {
    pantries: [
      { id: '1', name: 'Pantry A', location: 'Riyadh', items: [] },
      { id: '2', name: 'Pantry B', location: 'Jeddah', items: [] }
    ]
  };

  let currentPantryId = localStorage.getItem('currentPantryId') || '1';
  let editIndex = null;

  const pantrySelect = document.getElementById('pantrySelect');
  const currentPantryTitle = document.getElementById('currentPantryTitle');
  const itemTable = document.getElementById('itemTable');
  const editForm = document.getElementById('editForm');

  function populatePantrySelect() {
    pantrySelect.innerHTML = '';
    data.pantries.forEach(p => {
      const option = document.createElement('option');
      option.value = p.id;
      option.textContent = `${p.name} (${p.location})`;
      pantrySelect.appendChild(option);
    });
    pantrySelect.value = currentPantryId;
  }

  pantrySelect.onchange = function () {
    currentPantryId = pantrySelect.value;
    localStorage.setItem('currentPantryId', currentPantryId);
    showCurrentPantry();
  };

  function showCurrentPantry() {
    const pantry = data.pantries.find(p => p.id === currentPantryId);
    if (pantry) {
      currentPantryTitle.textContent = `${pantry.name} (${pantry.location})`;
      renderItems();
    }
  }

  function renderItems() {
    const pantry = data.pantries.find(p => p.id === currentPantryId);
    const tbody = itemTable.querySelector('tbody');
    tbody.innerHTML = '';

    if (pantry.items.length === 0) {
      itemTable.style.display = 'none';
      return;
    }

    itemTable.style.display = 'table';

    pantry.items.forEach((item, index) => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${item.name}</td>
        <td>${item.quantity}</td>
        <td>
          <button onclick="editItem(${index})">Edit</button>
          <button onclick="deleteItem(${index})">Delete</button>
        </td>`;
      tbody.appendChild(row);
    });
  }

  function addItem() {
    const name = document.getElementById('itemName').value.trim();
    const qty = parseInt(document.getElementById('itemQty').value);
    if (!name || isNaN(qty) || qty <= 0) return;

    const pantry = data.pantries.find(p => p.id === currentPantryId);
    const existing = pantry.items.find(item => item.name.toLowerCase() === name.toLowerCase());

    if (existing) {
      existing.quantity += qty;
    } else {
      pantry.items.push({ name, quantity: qty });
    }

    document.getElementById('itemName').value = '';
    document.getElementById('itemQty').value = '';
    renderItems();
  }

  function deleteItem(index) {
    const pantry = data.pantries.find(p => p.id === currentPantryId);
    pantry.items.splice(index, 1);
    renderItems();
  }

  function editItem(index) {
    const pantry = data.pantries.find(p => p.id === currentPantryId);
    const item = pantry.items[index];
    document.getElementById('editItemName').value = item.name;
    document.getElementById('editItemQty').value = item.quantity;
    editForm.style.display = 'block';
    editIndex = index;
  }

  function updateItem() {
    const pantry = data.pantries.find(p => p.id === currentPantryId);
    const newQty = parseInt(document.getElementById('editItemQty').value);
    if (!isNaN(newQty) && newQty >= 0) {
      pantry.items[editIndex].quantity = newQty;
      editForm.style.display = 'none';
      renderItems();
    }
  }

  function cancelEdit() {
    editForm.style.display = 'none';
    editIndex = null;
  }

  // Initialize
  populatePantrySelect();
  showCurrentPantry();
</script>

</body>
</html>
